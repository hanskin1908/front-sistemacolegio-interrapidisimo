{"ast":null,"code":"import { forkJoin } from 'rxjs';\nimport * as i0 from \"@angular/core\";\nimport * as i1 from \"../../../servicios/asignatura.servicio\";\nimport * as i2 from \"../../../servicios/inscripcion.servicio\";\nimport * as i3 from \"../../../servicios/autenticacion.servicio\";\nimport * as i4 from \"@angular/common\";\nimport * as i5 from \"@angular/forms\";\nfunction RegistroMateriasComponente_div_3_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 6)(1, \"div\", 7)(2, \"span\", 8);\n    i0.ɵɵtext(3, \"Cargando...\");\n    i0.ɵɵelementEnd()()();\n  }\n}\nfunction RegistroMateriasComponente_div_4_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 9);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r1 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r1.error, \" \");\n  }\n}\nfunction RegistroMateriasComponente_div_5_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 10);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r2 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\" \", ctx_r2.mensaje, \" \");\n  }\n}\nfunction RegistroMateriasComponente_div_6_div_10_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"p\");\n    i0.ɵɵtext(2, \"No tienes materias inscritas actualmente.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction RegistroMateriasComponente_div_6_div_11_div_1_p_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"p\", 26);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const inscripcion_r9 = i0.ɵɵnextContext().$implicit;\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate1(\"Cu00f3digo: \", inscripcion_r9.asignatura == null ? null : inscripcion_r9.asignatura.codigo, \"\");\n  }\n}\nfunction RegistroMateriasComponente_div_6_div_11_div_1_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r13 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\", 24)(1, \"div\", 25)(2, \"h5\", 26);\n    i0.ɵɵtext(3);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"button\", 27);\n    i0.ɵɵlistener(\"click\", function RegistroMateriasComponente_div_6_div_11_div_1_Template_button_click_4_listener() {\n      const restoredCtx = i0.ɵɵrestoreView(_r13);\n      const inscripcion_r9 = restoredCtx.$implicit;\n      const ctx_r12 = i0.ɵɵnextContext(3);\n      return i0.ɵɵresetView(ctx_r12.desinscribirAsignatura(inscripcion_r9.id || 0));\n    });\n    i0.ɵɵelement(5, \"i\", 28);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵtemplate(6, RegistroMateriasComponente_div_6_div_11_div_1_p_6_Template, 2, 1, \"p\", 29);\n    i0.ɵɵelementStart(7, \"small\");\n    i0.ɵɵtext(8);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(9, \"div\", 30)(10, \"button\", 31);\n    i0.ɵɵtext(11, \" Ver compau00f1eros \");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelement(12, \"div\", 32);\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const inscripcion_r9 = ctx.$implicit;\n    i0.ɵɵadvance(3);\n    i0.ɵɵtextInterpolate(inscripcion_r9.asignatura == null ? null : inscripcion_r9.asignatura.nombre);\n    i0.ɵɵadvance(3);\n    i0.ɵɵproperty(\"ngIf\", inscripcion_r9.asignatura == null ? null : inscripcion_r9.asignatura.codigo);\n    i0.ɵɵadvance(2);\n    i0.ɵɵtextInterpolate1(\"Fecha de inscripciu00f3n: \", inscripcion_r9.fechaInscripcion, \"\");\n    i0.ɵɵadvance(2);\n    i0.ɵɵattribute(\"data-bs-target\", \"#companeros-\" + inscripcion_r9.id);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"id\", \"companeros-\" + inscripcion_r9.id);\n  }\n}\nfunction RegistroMateriasComponente_div_6_div_11_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 22);\n    i0.ɵɵtemplate(1, RegistroMateriasComponente_div_6_div_11_div_1_Template, 13, 5, \"div\", 23);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const ctx_r5 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r5.misAsignaturas);\n  }\n}\nfunction RegistroMateriasComponente_div_6_div_18_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\", 21)(1, \"p\");\n    i0.ɵɵtext(2, \"No hay materias disponibles para inscribir.\");\n    i0.ɵɵelementEnd()();\n  }\n}\nfunction RegistroMateriasComponente_div_6_div_19_option_7_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"option\", 36);\n    i0.ɵɵtext(1);\n    i0.ɵɵelementEnd();\n  }\n  if (rf & 2) {\n    const asignatura_r15 = ctx.$implicit;\n    i0.ɵɵproperty(\"value\", asignatura_r15.id);\n    i0.ɵɵadvance(1);\n    i0.ɵɵtextInterpolate3(\" \", asignatura_r15.nombre, \" (\", asignatura_r15.codigo, \") - \", asignatura_r15.creditos, \" cru00e9ditos \");\n  }\n}\nfunction RegistroMateriasComponente_div_6_div_19_Template(rf, ctx) {\n  if (rf & 1) {\n    const _r17 = i0.ɵɵgetCurrentView();\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 33)(2, \"label\", 34);\n    i0.ɵɵtext(3, \"Selecciona una materia:\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(4, \"select\", 35);\n    i0.ɵɵlistener(\"ngModelChange\", function RegistroMateriasComponente_div_6_div_19_Template_select_ngModelChange_4_listener($event) {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r16 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r16.asignaturaSeleccionada = $event);\n    });\n    i0.ɵɵelementStart(5, \"option\", 36);\n    i0.ɵɵtext(6, \"-- Selecciona una materia --\");\n    i0.ɵɵelementEnd();\n    i0.ɵɵtemplate(7, RegistroMateriasComponente_div_6_div_19_option_7_Template, 2, 4, \"option\", 37);\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(8, \"button\", 38);\n    i0.ɵɵlistener(\"click\", function RegistroMateriasComponente_div_6_div_19_Template_button_click_8_listener() {\n      i0.ɵɵrestoreView(_r17);\n      const ctx_r18 = i0.ɵɵnextContext(2);\n      return i0.ɵɵresetView(ctx_r18.inscribirAsignatura());\n    });\n    i0.ɵɵelement(9, \"i\", 39);\n    i0.ɵɵtext(10, \" Inscribir Materia \");\n    i0.ɵɵelementEnd()();\n  }\n  if (rf & 2) {\n    const ctx_r7 = i0.ɵɵnextContext(2);\n    i0.ɵɵadvance(4);\n    i0.ɵɵproperty(\"ngModel\", ctx_r7.asignaturaSeleccionada);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"value\", null);\n    i0.ɵɵadvance(2);\n    i0.ɵɵproperty(\"ngForOf\", ctx_r7.asignaturasDisponibles);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"disabled\", !ctx_r7.asignaturaSeleccionada || ctx_r7.cargando);\n  }\n}\nfunction RegistroMateriasComponente_div_6_Template(rf, ctx) {\n  if (rf & 1) {\n    i0.ɵɵelementStart(0, \"div\")(1, \"div\", 11);\n    i0.ɵɵelement(2, \"div\", 12);\n    i0.ɵɵelementEnd();\n    i0.ɵɵelementStart(3, \"div\", 13)(4, \"div\", 12)(5, \"div\", 14)(6, \"div\", 15)(7, \"h5\", 16);\n    i0.ɵɵtext(8, \"Mis Materias Inscritas\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(9, \"div\", 17);\n    i0.ɵɵtemplate(10, RegistroMateriasComponente_div_6_div_10_Template, 3, 0, \"div\", 18);\n    i0.ɵɵtemplate(11, RegistroMateriasComponente_div_6_div_11_Template, 2, 1, \"div\", 19);\n    i0.ɵɵelementEnd()()();\n    i0.ɵɵelementStart(12, \"div\", 12)(13, \"div\", 14)(14, \"div\", 20)(15, \"h5\", 16);\n    i0.ɵɵtext(16, \"Inscribir Nueva Materia\");\n    i0.ɵɵelementEnd()();\n    i0.ɵɵelementStart(17, \"div\", 17);\n    i0.ɵɵtemplate(18, RegistroMateriasComponente_div_6_div_18_Template, 3, 0, \"div\", 18);\n    i0.ɵɵtemplate(19, RegistroMateriasComponente_div_6_div_19_Template, 11, 4, \"div\", 5);\n    i0.ɵɵelementEnd()()()()();\n  }\n  if (rf & 2) {\n    const ctx_r3 = i0.ɵɵnextContext();\n    i0.ɵɵadvance(10);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.misAsignaturas.length === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.misAsignaturas.length > 0);\n    i0.ɵɵadvance(7);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.asignaturasDisponibles.length === 0);\n    i0.ɵɵadvance(1);\n    i0.ɵɵproperty(\"ngIf\", ctx_r3.asignaturasDisponibles.length > 0);\n  }\n}\nexport class RegistroMateriasComponente {\n  constructor(asignaturaServicio, inscripcionServicio, autenticacionServicio) {\n    this.asignaturaServicio = asignaturaServicio;\n    this.inscripcionServicio = inscripcionServicio;\n    this.autenticacionServicio = autenticacionServicio;\n    this.asignaturasDisponibles = [];\n    this.misAsignaturas = [];\n    this.estudianteId = null;\n    this.nombreEstudiante = '';\n    this.cargando = false;\n    this.error = '';\n    this.mensaje = '';\n    this.asignaturaSeleccionada = null;\n  }\n  ngOnInit() {\n    const usuario = this.autenticacionServicio.obtenerUsuarioActual();\n    console.log('Usuario autenticado:', usuario);\n    console.log(usuario?.studentId);\n    if (usuario && usuario.studentId) {\n      this.estudianteId = usuario.studentId;\n      this.nombreEstudiante = usuario.name;\n      this.cargarDatos();\n    } else {\n      this.error = 'No se pudo identificar al estudiante';\n    }\n  }\n  cargarDatos() {\n    if (!this.estudianteId) return;\n    this.cargando = true;\n    this.error = '';\n    this.mensaje = '';\n    forkJoin({\n      asignaturas: this.asignaturaServicio.obtenerAsignaturas(),\n      inscripciones: this.inscripcionServicio.obtenerInscripcionesEstudiante(this.estudianteId)\n    }).subscribe({\n      next: resultado => {\n        this.misAsignaturas = resultado.inscripciones;\n        // Filtrar asignaturas ya inscritas\n        const asignaturasInscritas = new Set(this.misAsignaturas.map(i => i.asignaturaId));\n        this.asignaturasDisponibles = resultado.asignaturas.filter(a => !asignaturasInscritas.has(a.id));\n        this.cargando = false;\n      },\n      error: err => {\n        this.error = 'Error al cargar los datos: ' + err.message;\n        this.cargando = false;\n      }\n    });\n  }\n  inscribirAsignatura() {\n    if (!this.estudianteId || !this.asignaturaSeleccionada) {\n      this.error = 'Debe seleccionar una asignatura';\n      return;\n    }\n    this.cargando = true;\n    this.error = '';\n    this.mensaje = '';\n    const asignaturaSeleccionada = this.asignaturasDisponibles.find(a => a.id === this.asignaturaSeleccionada);\n    if (!asignaturaSeleccionada) {\n      this.error = 'Asignatura no encontrada';\n      this.cargando = false;\n      return;\n    }\n    this.inscripcionServicio.inscribirAsignatura({\n      estudianteId: this.estudianteId,\n      nombreEstudiante: this.nombreEstudiante,\n      asignaturaId: this.asignaturaSeleccionada,\n      nombreAsignatura: asignaturaSeleccionada.nombre\n    }).subscribe({\n      next: inscripcion => {\n        this.mensaje = `Te has inscrito exitosamente en ${asignaturaSeleccionada.nombre}`;\n        this.asignaturaSeleccionada = null;\n        this.cargarDatos();\n      },\n      error: err => {\n        this.error = 'Error al inscribir la asignatura: ' + err.message;\n        this.cargando = false;\n      }\n    });\n  }\n  desinscribirAsignatura(inscripcionId) {\n    if (!confirm('¿Estu00e1s seguro de que deseas eliminar esta inscripciu00f3n?')) {\n      return;\n    }\n    this.cargando = true;\n    this.error = '';\n    this.mensaje = '';\n    this.inscripcionServicio.desinscribirAsignatura(inscripcionId).subscribe({\n      next: () => {\n        this.mensaje = 'Inscripciu00f3n eliminada exitosamente';\n        this.cargarDatos();\n      },\n      error: err => {\n        this.error = 'Error al eliminar la inscripciu00f3n: ' + err.message;\n        this.cargando = false;\n      }\n    });\n  }\n  static {\n    this.ɵfac = function RegistroMateriasComponente_Factory(t) {\n      return new (t || RegistroMateriasComponente)(i0.ɵɵdirectiveInject(i1.AsignaturaServicio), i0.ɵɵdirectiveInject(i2.InscripcionServicio), i0.ɵɵdirectiveInject(i3.AutenticacionServicio));\n    };\n  }\n  static {\n    this.ɵcmp = /*@__PURE__*/i0.ɵɵdefineComponent({\n      type: RegistroMateriasComponente,\n      selectors: [[\"app-registro-materias\"]],\n      decls: 7,\n      vars: 4,\n      consts: [[1, \"container\"], [1, \"mb-4\"], [\"class\", \"text-center p-5\", 4, \"ngIf\"], [\"class\", \"alert alert-danger\", 4, \"ngIf\"], [\"class\", \"alert alert-success\", 4, \"ngIf\"], [4, \"ngIf\"], [1, \"text-center\", \"p-5\"], [\"role\", \"status\", 1, \"spinner-border\", \"text-primary\"], [1, \"visually-hidden\"], [1, \"alert\", \"alert-danger\"], [1, \"alert\", \"alert-success\"], [1, \"row\"], [1, \"col-md-6\"], [1, \"row\", \"mt-4\"], [1, \"card\"], [1, \"card-header\", \"bg-primary\", \"text-white\"], [1, \"mb-0\"], [1, \"card-body\"], [\"class\", \"text-center text-muted\", 4, \"ngIf\"], [\"class\", \"list-group\", 4, \"ngIf\"], [1, \"card-header\", \"bg-success\", \"text-white\"], [1, \"text-center\", \"text-muted\"], [1, \"list-group\"], [\"class\", \"list-group-item list-group-item-action flex-column align-items-start\", 4, \"ngFor\", \"ngForOf\"], [1, \"list-group-item\", \"list-group-item-action\", \"flex-column\", \"align-items-start\"], [1, \"d-flex\", \"w-100\", \"justify-content-between\"], [1, \"mb-1\"], [1, \"btn\", \"btn-sm\", \"btn-danger\", 3, \"click\"], [1, \"bi\", \"bi-trash\"], [\"class\", \"mb-1\", 4, \"ngIf\"], [1, \"mt-3\"], [\"type\", \"button\", \"data-bs-toggle\", \"collapse\", \"aria-expanded\", \"false\", 1, \"btn\", \"btn-sm\", \"btn-outline-primary\"], [1, \"collapse\", \"mt-2\", 3, \"id\"], [1, \"form-group\", \"mb-3\"], [\"for\", \"asignaturaSelect\", 1, \"form-label\"], [\"id\", \"asignaturaSelect\", 1, \"form-select\", 3, \"ngModel\", \"ngModelChange\"], [3, \"value\"], [3, \"value\", 4, \"ngFor\", \"ngForOf\"], [1, \"btn\", \"btn-success\", 3, \"disabled\", \"click\"], [1, \"bi\", \"bi-plus-circle\", \"me-1\"]],\n      template: function RegistroMateriasComponente_Template(rf, ctx) {\n        if (rf & 1) {\n          i0.ɵɵelementStart(0, \"div\", 0)(1, \"h2\", 1);\n          i0.ɵɵtext(2, \"Registro de Materias\");\n          i0.ɵɵelementEnd();\n          i0.ɵɵtemplate(3, RegistroMateriasComponente_div_3_Template, 4, 0, \"div\", 2);\n          i0.ɵɵtemplate(4, RegistroMateriasComponente_div_4_Template, 2, 1, \"div\", 3);\n          i0.ɵɵtemplate(5, RegistroMateriasComponente_div_5_Template, 2, 1, \"div\", 4);\n          i0.ɵɵtemplate(6, RegistroMateriasComponente_div_6_Template, 20, 4, \"div\", 5);\n          i0.ɵɵelementEnd();\n        }\n        if (rf & 2) {\n          i0.ɵɵadvance(3);\n          i0.ɵɵproperty(\"ngIf\", ctx.cargando);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.error);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", ctx.mensaje);\n          i0.ɵɵadvance(1);\n          i0.ɵɵproperty(\"ngIf\", !ctx.cargando && !ctx.error);\n        }\n      },\n      dependencies: [i4.NgForOf, i4.NgIf, i5.NgSelectOption, i5.ɵNgSelectMultipleOption, i5.SelectControlValueAccessor, i5.NgControlStatus, i5.NgModel],\n      styles: [\".card[_ngcontent-%COMP%] {\\n  margin-bottom: 20px;\\n  box-shadow: 0 2px 4px rgba(0, 0, 0, 0.1);\\n}\\n\\n.card-header[_ngcontent-%COMP%] {\\n  font-weight: 500;\\n}\\n\\n.list-group-item[_ngcontent-%COMP%] {\\n  transition: background-color 0.2s;\\n}\\n\\n.list-group-item[_ngcontent-%COMP%]:hover {\\n  background-color: #f8f9fa;\\n}\\n/*# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly8uL3NyYy9hcHAvY29tcG9uZW50ZXMvZXN0dWRpYW50ZXMvcmVnaXN0cm8tbWF0ZXJpYXMvcmVnaXN0cm8tbWF0ZXJpYXMuY29tcG9uZW50ZS5jc3MiXSwibmFtZXMiOltdLCJtYXBwaW5ncyI6IkFBQUE7RUFDRSxtQkFBbUI7RUFDbkIsd0NBQXdDO0FBQzFDOztBQUVBO0VBQ0UsZ0JBQWdCO0FBQ2xCOztBQUVBO0VBQ0UsaUNBQWlDO0FBQ25DOztBQUVBO0VBQ0UseUJBQXlCO0FBQzNCIiwic291cmNlc0NvbnRlbnQiOlsiLmNhcmQge1xuICBtYXJnaW4tYm90dG9tOiAyMHB4O1xuICBib3gtc2hhZG93OiAwIDJweCA0cHggcmdiYSgwLCAwLCAwLCAwLjEpO1xufVxuXG4uY2FyZC1oZWFkZXIge1xuICBmb250LXdlaWdodDogNTAwO1xufVxuXG4ubGlzdC1ncm91cC1pdGVtIHtcbiAgdHJhbnNpdGlvbjogYmFja2dyb3VuZC1jb2xvciAwLjJzO1xufVxuXG4ubGlzdC1ncm91cC1pdGVtOmhvdmVyIHtcbiAgYmFja2dyb3VuZC1jb2xvcjogI2Y4ZjlmYTtcbn0iXSwic291cmNlUm9vdCI6IiJ9 */\"]\n    });\n  }\n}","map":{"version":3,"mappings":"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","names":["forkJoin","i0","RegistroMateriasComponente","constructor","asignaturaServicio","inscripcionServicio","autenticacionServicio","ngOnInit","usuario","obtenerUsuarioActual","console","log","studentId","estudianteId","nombreEstudiante","name","cargarDatos","error","cargando","mensaje","asignaturas","obtenerAsignaturas","inscripciones","obtenerInscripcionesEstudiante","subscribe","next","resultado","misAsignaturas","asignaturasInscritas","Set","map","i","asignaturaId","asignaturasDisponibles","filter","a","has","id","err","message","inscribirAsignatura","asignaturaSeleccionada","find","nombreAsignatura","nombre","inscripcion","desinscribirAsignatura","inscripcionId","confirm","selectors","decls","vars","consts","template"],"sourceRoot":"","sources":["C:\\Users\\hansk\\Videos\\frontendsistemacolegio.interrapidisi\\frontendsistemacolegio.interrapidisi\\src\\app\\componentes\\estudiantes\\registro-materias\\registro-materias.componente.ts","C:\\Users\\hansk\\Videos\\frontendsistemacolegio.interrapidisi\\frontendsistemacolegio.interrapidisi\\src\\app\\componentes\\estudiantes\\registro-materias\\registro-materias.componente.html"],"sourcesContent":["import { Component, OnInit } from '@angular/core';\nimport { AsignaturaServicio } from '../../../servicios/asignatura.servicio';\nimport { InscripcionServicio } from '../../../servicios/inscripcion.servicio';\nimport { AutenticacionServicio } from '../../../servicios/autenticacion.servicio';\nimport { Asignatura } from '../../../modelos/asignatura.modelo';\nimport { Inscripcion } from '../../../modelos/inscripcion.modelo';\nimport { forkJoin, of } from 'rxjs';\nimport { switchMap, catchError } from 'rxjs/operators';\n\n@Component({\n  selector: 'app-registro-materias',\n  templateUrl: './registro-materias.componente.html',\n  styleUrls: ['./registro-materias.componente.css']\n})\nexport class RegistroMateriasComponente implements OnInit {\n  asignaturasDisponibles: Asignatura[] = [];\n  misAsignaturas: Inscripcion[] = [];\n  estudianteId: number | null = null;\n  nombreEstudiante: string = '';\n  cargando = false;\n  error = '';\n  mensaje = '';\n  asignaturaSeleccionada: number | null = null;\n\n  constructor(\n    private asignaturaServicio: AsignaturaServicio,\n    private inscripcionServicio: InscripcionServicio,\n    private autenticacionServicio: AutenticacionServicio\n  ) { }\n\n  ngOnInit(): void {\n    const usuario = this.autenticacionServicio.obtenerUsuarioActual();\n    console.log('Usuario autenticado:', usuario);\n    console.log(usuario?.studentId)\n    if (usuario && usuario.studentId) {\n      this.estudianteId = usuario.studentId;\n      this.nombreEstudiante = usuario.name;\n      this.cargarDatos();\n    } else {\n      this.error = 'No se pudo identificar al estudiante';\n    }\n  }\n\n  cargarDatos(): void {\n    if (!this.estudianteId) return;\n\n    this.cargando = true;\n    this.error = '';\n    this.mensaje = '';\n\n    forkJoin({\n      asignaturas: this.asignaturaServicio.obtenerAsignaturas(),\n      inscripciones: this.inscripcionServicio.obtenerInscripcionesEstudiante(this.estudianteId)\n    }).subscribe({\n      next: (resultado) => {\n        this.misAsignaturas = resultado.inscripciones;\n        \n        // Filtrar asignaturas ya inscritas\n        const asignaturasInscritas = new Set(this.misAsignaturas.map(i => i.asignaturaId));\n        this.asignaturasDisponibles = resultado.asignaturas.filter(a => !asignaturasInscritas.has(a.id));\n        \n        this.cargando = false;\n      },\n      error: (err) => {\n        this.error = 'Error al cargar los datos: ' + err.message;\n        this.cargando = false;\n      }\n    });\n  }\n\n  inscribirAsignatura(): void {\n    if (!this.estudianteId || !this.asignaturaSeleccionada) {\n      this.error = 'Debe seleccionar una asignatura';\n      return;\n    }\n\n    this.cargando = true;\n    this.error = '';\n    this.mensaje = '';\n\n    const asignaturaSeleccionada = this.asignaturasDisponibles.find(a => a.id === this.asignaturaSeleccionada);\n    \n    if (!asignaturaSeleccionada) {\n      this.error = 'Asignatura no encontrada';\n      this.cargando = false;\n      return;\n    }\n\n    this.inscripcionServicio.inscribirAsignatura({\n      estudianteId: this.estudianteId,\n      nombreEstudiante: this.nombreEstudiante,\n      asignaturaId: this.asignaturaSeleccionada,\n      nombreAsignatura: asignaturaSeleccionada.nombre\n    }).subscribe({\n      next: (inscripcion: any) => {\n        this.mensaje = `Te has inscrito exitosamente en ${asignaturaSeleccionada.nombre}`;\n        this.asignaturaSeleccionada = null;\n        this.cargarDatos();\n      },\n      error: (err: any) => {\n        this.error = 'Error al inscribir la asignatura: ' + err.message;\n        this.cargando = false;\n      }\n    });\n  }\n\n  desinscribirAsignatura(inscripcionId: number): void {\n    if (!confirm('¿Estu00e1s seguro de que deseas eliminar esta inscripciu00f3n?')) {\n      return;\n    }\n\n    this.cargando = true;\n    this.error = '';\n    this.mensaje = '';\n\n    this.inscripcionServicio.desinscribirAsignatura(inscripcionId).subscribe({\n      next: () => {\n        this.mensaje = 'Inscripciu00f3n eliminada exitosamente';\n        this.cargarDatos();\n      },\n      error: (err: any) => {\n        this.error = 'Error al eliminar la inscripciu00f3n: ' + err.message;\n        this.cargando = false;\n      }\n    });\n  }\n}","<div class=\"container\">\n  <h2 class=\"mb-4\">Registro de Materias</h2>\n  \n  <div *ngIf=\"cargando\" class=\"text-center p-5\">\n    <div class=\"spinner-border text-primary\" role=\"status\">\n      <span class=\"visually-hidden\">Cargando...</span>\n    </div>\n  </div>\n  \n  <div *ngIf=\"error\" class=\"alert alert-danger\">\n    {{ error }}\n  </div>\n  \n  <div *ngIf=\"mensaje\" class=\"alert alert-success\">\n    {{ mensaje }}\n  </div>\n  \n  <div *ngIf=\"!cargando && !error\">\n    <div class=\"row\">\n      <div class=\"col-md-6\">\n        <!-- Creditos estudiante component will be added later -->\n      </div>\n    </div>\n    \n    <div class=\"row mt-4\">\n      <div class=\"col-md-6\">\n        <div class=\"card\">\n          <div class=\"card-header bg-primary text-white\">\n            <h5 class=\"mb-0\">Mis Materias Inscritas</h5>\n          </div>\n          <div class=\"card-body\">\n            <div *ngIf=\"misAsignaturas.length === 0\" class=\"text-center text-muted\">\n              <p>No tienes materias inscritas actualmente.</p>\n            </div>\n            \n            <div *ngIf=\"misAsignaturas.length > 0\" class=\"list-group\">\n              <div *ngFor=\"let inscripcion of misAsignaturas\" class=\"list-group-item list-group-item-action flex-column align-items-start\">\n                <div class=\"d-flex w-100 justify-content-between\">\n                  <h5 class=\"mb-1\">{{ inscripcion.asignatura?.nombre }}</h5>\n                  <button class=\"btn btn-sm btn-danger\" (click)=\"desinscribirAsignatura(inscripcion.id || 0)\">\n                    <i class=\"bi bi-trash\"></i>\n                  </button>\n                </div>\n                <p class=\"mb-1\" *ngIf=\"inscripcion.asignatura?.codigo\">Cu00f3digo: {{ inscripcion.asignatura?.codigo }}</p>\n                <small>Fecha de inscripciu00f3n: {{ inscripcion.fechaInscripcion }}</small>\n                \n                <div class=\"mt-3\">\n                  <button class=\"btn btn-sm btn-outline-primary\" type=\"button\" data-bs-toggle=\"collapse\" [attr.data-bs-target]=\"'#companeros-' + inscripcion.id\" aria-expanded=\"false\">\n                    Ver compau00f1eros\n                  </button>\n                  <div class=\"collapse mt-2\" [id]=\"'companeros-' + inscripcion.id\">\n                    <!-- Companeros component will be added later -->\n                  </div>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      </div>\n      \n      <div class=\"col-md-6\">\n        <div class=\"card\">\n          <div class=\"card-header bg-success text-white\">\n            <h5 class=\"mb-0\">Inscribir Nueva Materia</h5>\n          </div>\n          <div class=\"card-body\">\n            <div *ngIf=\"asignaturasDisponibles.length === 0\" class=\"text-center text-muted\">\n              <p>No hay materias disponibles para inscribir.</p>\n            </div>\n            \n            <div *ngIf=\"asignaturasDisponibles.length > 0\">\n              <div class=\"form-group mb-3\">\n                <label for=\"asignaturaSelect\" class=\"form-label\">Selecciona una materia:</label>\n                <select class=\"form-select\" id=\"asignaturaSelect\" [(ngModel)]=\"asignaturaSeleccionada\">\n                  <option [value]=\"null\">-- Selecciona una materia --</option>\n                  <option *ngFor=\"let asignatura of asignaturasDisponibles\" [value]=\"asignatura.id\">\n                    {{ asignatura.nombre }} ({{ asignatura.codigo }}) - {{ asignatura.creditos }} cru00e9ditos\n                  </option>\n                </select>\n              </div>\n              \n              <button class=\"btn btn-success\" [disabled]=\"!asignaturaSeleccionada || cargando\" (click)=\"inscribirAsignatura()\">\n                <i class=\"bi bi-plus-circle me-1\"></i> Inscribir Materia\n              </button>\n            </div>\n          </div>\n        </div>\n      </div>\n    </div>\n  </div>\n</div>"]},"metadata":{},"sourceType":"module","externalDependencies":[]}